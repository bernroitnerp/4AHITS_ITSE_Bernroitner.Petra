Petra Bernroitner, 4AHITS, 17.11.2025


# Vulnerability Scanning

Cybersecurity 4 Lab


## Übung (Optionen)

Analysiere die Bedeutung der folgenden Optionen:
```$ nmap -Pn -sS -sV -sC -oN nmap_default.txt 10.10.92.153```

Was führt nmap in diesem Fall für einen Scan aus? Wie viele Ports werden gescannt. Scanne mit diesem Befehl die metasploitable VM.


-> führt einen Port- und Service-Scan mit nmap auf dem Ziel 10.10.92.153 aus.

---

- nmap

Das Netzwerk-Scanning-Tool selbst.

---


- -Pn

Kein Ping-Scan.
Nmap geht davon aus, dass der Host online ist, (überspringt die Host-Erkennung z.B. Ping-Probes) auch wenn er nicht auf ICMP/Ping antwortet.
→ Nützlich, wenn Firewalls Pings blockieren.

---

- -sS

Führt einen TCP-SYN-Scan (Stealth-Scan auch „Half-open Scan“) durch, der im Allgemeinen schneller ist und vom Zielsystem seltener protokolliert wird als ein vollständiger TCP-Connect-Scan

Prüft, welche TCP-Ports offen sind

Erfordert meist Root-/Admin-Rechte

---

- -sV

Welche Dienste auf offenen Ports laufen (z. B. Apache, SSH)

Welche Versionsnummern diese haben

---

- -sC

 Ermöglicht die Verwendung der standardmäßigen Nmap-Skripte. Diese Skripte führen verschiedene 
Schwachstellenprüfungen durch und liefern detailliertere Informationen über die erkannten Dienste.

Häufige Fehlkonfigurationen

Basisinformationen zu Diensten

Teilweise einfache Sicherheitschecks
(kein aggressiver Exploit-Scan)

---

- -oN nmap_default.txt

Speichert die Scan-Ausgabe im Normalformat in der angegebenen Datei nmap_default.txt.

---

- 10.10.92.153

Die Ziel-IP-Adresse, die gescannt wird.


---

### Test auf Metasploitable

```bash
nmap -Pn -sS -sV -sC -oN nmap_default.txt 192.168.168.132


Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:15 EST
Nmap scan report for 192.168.168.132
Host is up (0.0028s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.168.128
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2025-12-15T11:16:16+00:00; +4s from scanner time.
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|_    SSL2_RC4_128_WITH_MD5
53/tcp   open  domain      ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-title: Metasploitable2 - Linux
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39776/tcp   mountd
|   100005  1,2,3      51203/udp   mountd
|   100021  1,3,4      41030/tcp   nlockmgr
|   100021  1,3,4      43894/udp   nlockmgr
|   100024  1          39594/tcp   status
|_  100024  1          48810/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 8
|   Capabilities flags: 43564
|   Some Capabilities: SupportsCompression, SupportsTransactions, SwitchToSSLAfterHandshake, Speaks41ProtocolNew, LongColumnFlag, Support41Auth, ConnectWithDatabase
|   Status: Autocommit
|_  Salt: FZpGP>"1mR3HP;uZF.Q0
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
|_ssl-date: 2025-12-15T11:16:16+00:00; +4s from scanner time.
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
5900/tcp open  vnc         VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 0:06:54
|   source ident: nmap
|   source host: 862F32E7.F488A6CC.FFFA6D49.IP
|_  error: Closing Link: fipxercsu[192.168.168.128] (Quit: fipxercsu)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-title: Apache Tomcat/5.5
|_http-server-header: Apache-Coyote/1.1
|_http-favicon: Apache Tomcat
MAC Address: 00:0C:29:FA:DD:2A (VMware)
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-12-15T06:16:06-05:00
|_smb2-time: Protocol negotiation failed (SMB2)
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
|_clock-skew: mean: 1h15m04s, deviation: 2h30m00s, median: 3s
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 23.69 seconds
```

## Übung (vulnerability scan)

nmap verfügt über eine Erweiterung über die Lua Scripts ausgeführt werden können. Die installierten Lua Scripts befinden sich im Directory /usr/share/nmap/scripts.

**Aufgabe 1:** Verwende die Option -sC um die Standard-Skripte auszuführen, zusätzlich beschränkt auf die 100 häufigsten Ports (Option -F) aus.

Anmerkung: nmap kann wertvolle Hinweise auf Schwachstellen liefern, ein vollwertiger vulnerability scaner ist es allerdings nicht, dafür gibt es eigene darauf spezialisierte Tools (z.B.: gvm … Greenbone Vulnerability Manager).

Der Scan mit Standard-NSE-Skripten (-sC), beschränkt auf die 100 häufigsten Ports (-F), sieht so aus: 

``` nmap -sC -F 192.168.168.132 ```

Ausgabe:

```bash
nmap -sC -F 192.168.168.132 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:22 EST
Nmap scan report for 192.168.168.132
Host is up (0.00026s latency).
Not shown: 82 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.168.128
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
22/tcp   open  ssh
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet
25/tcp   open  smtp
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC4_128_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|_    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|_smtp-ntlm-info: ERROR: Script execution failed (use -d to debug)
|_ssl-date: 2025-12-15T11:23:06+00:00; +6s from scanner time.
53/tcp   open  domain
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp   open  http
|_http-title: Metasploitable2 - Linux
111/tcp  open  rpcbind
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39776/tcp   mountd
|   100005  1,2,3      51203/udp   mountd
|   100021  1,3,4      41030/tcp   nlockmgr
|   100021  1,3,4      43894/udp   nlockmgr
|   100024  1          39594/tcp   status
|_  100024  1          48810/udp   status
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
513/tcp  open  login
514/tcp  open  shell
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 16
|   Capabilities flags: 43564
|   Some Capabilities: LongColumnFlag, Support41Auth, SwitchToSSLAfterHandshake, SupportsTransactions, SupportsCompression, Speaks41ProtocolNew, ConnectWithDatabase
|   Status: Autocommit
|_  Salt: ^w\G0XMVJP4Pv"AbI)/Q
5432/tcp open  postgresql
|_ssl-date: 2025-12-15T11:23:05+00:00; +5s from scanner time.
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
5900/tcp open  vnc
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11
8009/tcp open  ajp13
|_ajp-methods: Failed to get a valid response for the OPTION request
MAC Address: 00:0C:29:FA:DD:2A (VMware)

Host script results:
|_clock-skew: mean: 1h15m04s, deviation: 2h29m59s, median: 4s
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-12-15T06:22:19-05:00
|_smb2-time: Protocol negotiation failed (SMB2)

Nmap done: 1 IP address (1 host up) scanned in 46.02 seconds

```

Zusammenfassung der Ausgabe:

- Sehr viele offene Ports/Dienste

- Veraltete & unsichere Services (FTP anon, Telnet, rsh, altes SSL)

- Klare Versionsinfos → gut angreifbar

- SMB/NFS/Datenbanken/Web offen zugänglich

- Typisches Metasploitable-System mit großer Angriffsfläche

Also: *es ist extrem unsicher*


--- 


**Aufgabe 2:** verwende die Option --script um ausgewählte Skripte zu starten. Z.B. ```--script http-title,mysql-info,banner```. Probiere ca. 5 Skripte aus. Nimm die Metasploitable VM als Ziel.

https://nmap.org/nsedoc/scripts/


1. **afp-brute**

Performs password guessing against Apple Filing Protocol (AFP).

```nmap -Pn -sS -sV --script afp-brute 192.168.168.132 ```

Ausgabe:

```bash
nmap -Pn -sS -sV --script afp-brute 192.168.168.132  

Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:31 EST
Nmap scan report for 192.168.168.132
Host is up (0.0017s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39776/tcp   mountd
|   100005  1,2,3      51203/udp   mountd
|   100021  1,3,4      41030/tcp   nlockmgr
|   100021  1,3,4      43894/udp   nlockmgr
|   100024  1          39594/tcp   status
|_  100024  1          48810/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-server-header: Apache-Coyote/1.1
MAC Address: 00:0C:29:FA:DD:2A (VMware)

```

das kann man daraus erkennen:

- Nmap zeigt offene Ports inkl. Service & Versionen
- Viele veraltete und unsichere Dienste (FTP, Telnet, rsh, altes Apache/SSH)
- Web, SMB, NFS, Datenbanken offen erreichbar
- Sehr kritisch: Port 1524 = offene Root-Bind-Shell


2. **ftp-syst**

Sends FTP SYST and STAT commands and returns the result.
```bash
nmap -Pn -sS -sV --script ftp-syst 192.168.168.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:40 EST
Nmap scan report for 192.168.168.132
Host is up (0.0023s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.168.128
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39776/tcp   mountd
|   100005  1,2,3      51203/udp   mountd
|   100021  1,3,4      41030/tcp   nlockmgr
|   100021  1,3,4      43894/udp   nlockmgr
|   100024  1          39594/tcp   status
|_  100024  1          48810/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-server-header: Apache-Coyote/1.1
MAC Address: 00:0C:29:FA:DD:2A (VMware)
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.56 seconds
```


Das NSE-Skript liefert Detailinfos zu einem unsicheren FTP-Dienst.

- SYN- & Versionsscan mit gezieltem NSE-Skript ftp-syst
- FTP (vsftpd 2.3.4):
    - Serverstatus auslesbar
    - Anonymer Login aktiv
    - Unverschlüsselte Verbindungen

- Viele offene, veraltete Dienste (Telnet, rsh, SMB, NFS, alte Web- & DB-Server)
- Host- & OS-Infos eindeutig erkennbar (Linux / Metasploitable, VMware)




3. **broadcast-hid-discoveryd**

Discovers HID devices on a LAN by sending a discoveryd network broadcast probe.

```bash
nmap -Pn -sS -sV --script broadcast-hid-discoveryd 192.168.168.132 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:46 EST
Nmap scan report for 192.168.168.132
Host is up (0.0024s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39776/tcp   mountd
|   100005  1,2,3      51203/udp   mountd
|   100021  1,3,4      41030/tcp   nlockmgr
|   100021  1,3,4      43894/udp   nlockmgr
|   100024  1          39594/tcp   status
|_  100024  1          48810/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-server-header: Apache-Coyote/1.1
MAC Address: 00:0C:29:FA:DD:2A (VMware)
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 17.06 seconds
```

Das Skript ist ziel- und protokollfremd, deshalb keine zusätzlichen Informationen über den Host gewonnen.

- Normaler SYN‑ & Versionsscan wie zuvor
- Das gewählte NSE‑Skript broadcast-hid-discoveryd liefert *keine Ausgabe*

Grund:
- Das Skript ist ein Broadcast-/UDP‑Discovery‑Skript
- Es sucht Apple HID‑Discovery‑Dienste im lokalen Netz
- Nicht passend für ein Linux‑Server‑Ziel wie Metasploitable
- Ergebnis bleibt daher nur die Port‑ & Serviceauflistung

4. **ajp-auth**

Retrieves the authentication scheme and realm of an AJP service (Apache JServ Protocol) that requires authentication.

```bash
nmap -Pn -sS -sV --script ajp-auth 192.168.168.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:52 EST
Nmap scan report for 192.168.168.132
Host is up (0.0012s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39776/tcp   mountd
|   100005  1,2,3      51203/udp   mountd
|   100021  1,3,4      41030/tcp   nlockmgr
|   100021  1,3,4      43894/udp   nlockmgr
|   100024  1          39594/tcp   status
|_  100024  1          48810/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-server-header: Apache-Coyote/1.1
MAC Address: 00:0C:29:FA:DD:2A (VMware)
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.53 seconds
```


Zusammenfassung:
- AJP auf Port 8009 (Tomcat) vorhanden
- ajp-auth findet keine Authentifizierungsinfos
- Viele offene, unsichere Dienste bestätigt
- Kritisch: Port 1524 = offene Root‑Bind‑Shell
- Klar erkennbar: Metasploitable-Testsystem


5. **banner**

A simple banner grabber which connects to an open TCP port and prints out anything sent by the listening service within five seconds.

```bash
nmap -Pn -sS -sV --script banner 192.168.168.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:55 EST
Nmap scan report for 192.168.168.132
Host is up (0.0035s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
|_banner: 220 (vsFTPd 2.3.4)
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
|_banner: SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
23/tcp   open  telnet      Linux telnetd
|_banner: \xFF\xFD\x18\xFF\xFD \xFF\xFD#\xFF\xFD'
25/tcp   open  smtp        Postfix smtpd
|_banner: 220 metasploitable.localdomain ESMTP Postfix (Ubuntu)
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39776/tcp   mountd
|   100005  1,2,3      51203/udp   mountd
|   100021  1,3,4      41030/tcp   nlockmgr
|   100021  1,3,4      43894/udp   nlockmgr
|   100024  1          39594/tcp   status
|_  100024  1          48810/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
|_banner: \x01Where are you?
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
|_banner: root@metasploitable:/#
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
|_banner: 220 ProFTPD 1.3.1 Server (Debian) [::ffff:192.168.168.132]
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
| banner: >\x00\x00\x00\x0A5.0.51a-3ubuntu5\x00\x1E\x00\x00\x00rB/d*E[x\x
|_00,\xAA\x08\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\...
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
|_banner: RFB 003.003
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
| banner: :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostna
|_me...\x0D\x0A:irc.Metasploitable.LAN NOTICE AUTH :*** Couldn't resol...
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-server-header: Apache-Coyote/1.1
MAC Address: 00:0C:29:FA:DD:2A (VMware)
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 30.25 seconds
```

```banner``` zeigt, wie viel sensible Infos Dienste freiwillig preisgeben

- Banner‑Grabbing erfolgreich → Dienste verraten exakte Software & Versionen
- Klartext‑Protokolle sichtbar (FTP, Telnet, rsh, SMTP)
- Zwei FTP‑Server identifizierbar (vsftpd & ProFTPD)
- Mail‑, IRC‑, DB‑ und VNC‑Banner liefern Host‑ und Dienstnamen
- Extrem kritisch:
    - Port 1524 gibt direkt eine root@metasploitable:/#‑Shell preis
- System eindeutig als Metasploitable (Linux, VM) erkennbar


---

**Aufgabe 3:** finde ein weiteres Skript das bei der Metasploitable VM sinnvolle Ergebnisse liefert


```smb‑os‑discovery```

Versucht über SMB (Ports 139/445) Informationen zum Betriebssystem, Workgroup/Domain und Systemzeit zu erhalten.

Das liefert oft NetBIOS‑/SMB‑Metadaten, die über einfache Port‑Scans hinausgehen. 

*Warum?*

Metasploitable hat einen Samba‑Dienst, der sich gut für SMB‑Erkennung eignet

Das Script kann zusätzliche System‑/Domain‑Infos ausgeben, die in normalen Scan‑Ergebnissen nicht stehen

```bash
nmap -Pn -sS -sV --script smb-os-discovery 192.168.168.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 07:01 EST
Nmap scan report for 192.168.168.132
Host is up (0.0079s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39776/tcp   mountd
|   100005  1,2,3      51203/udp   mountd
|   100021  1,3,4      41030/tcp   nlockmgr
|   100021  1,3,4      43894/udp   nlockmgr
|   100024  1          39594/tcp   status
|_  100024  1          48810/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-server-header: Apache-Coyote/1.1
MAC Address: 00:0C:29:FA:DD:2A (VMware)
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-12-15T07:02:15-05:00

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.15 seconds
```
Also:
- SMB aktiv (139/445) mit Samba 3.0.20 (Debian) → sehr alt
- Betriebssystem erkannt: Unix/Linux
- Hostname: metasploitable
- Domain/FQDN: metasploitable.localdomain
- Systemzeit auslesbar (SMB‑Info‑Leak)
- Kritisch bestätigt: Port 1524 = offene Root‑Shell


**Aufgabe 4:** Die nmap Skripte sind in Kategorien eingeteilt, es gibt z.B. eine Kategorie vuln (Siehe Kategorie vuln). Verwende die Option --script=vuln um alle Skripte dieser Kategorie zu starten. Verwende als Ziel die Metasploitable VM. Dieser Scan dauert sehr lange, schränke ein auf die Ports von FTP und HTTP.


Code:

```nmap -Pn -sS -sV --script=vuln -p 21,80 192.168.168.132```


*Erklärung:*

```--script=vuln``` → führt alle NSE‑Skripte der Kategorie „vuln“ aus

```-p 21,80``` → beschränkt den Scan auf FTP (21) und HTTP (80)

```-sS -sV``` → SYN‑Scan + Service/Versions­erkennung

```-Pn``` → kein Ping, Host wird als erreichbar angenommen

---


Hier ist eine verkürzte Ausgabe, weil sie wirklich seeeehr lange ist.

Es fehlt:

- Vollständige HTTP‑Spider‑Details
- Weitere Ports/Dienste außerhalb 21 & 80
- Tiefere manuelle Verifikation



```bash
nmap -Pn -sS -sV --script=vuln -p 21,80 192.168.168.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 07:05 EST
Stats: 0:04:49 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.91% done; ETC: 07:10 (0:00:03 remaining)
Nmap scan report for 192.168.168.132
Host is up (0.0017s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.3.4
| vulners: 
|   vsftpd 2.3.4: 
|       PACKETSTORM:162145      10.0    https://vulners.com/packetstorm/PACKETSTORM:162145      *EXPLOIT*
|       EDB-ID:49757    10.0    https://vulners.com/exploitdb/EDB-ID:49757      *EXPLOIT*
|       E9B0AEBB-5138-50BF-8922-2D87E3C046DD    10.0    https://vulners.com/githubexploit/E9B0AEBB-5138-50BF-8922-2D87E3C046DD  *EXPLOIT*
|       CVE-2011-2523   10.0    https://vulners.com/cve/CVE-2011-2523
|       CNVD-2020-46837 10.0    https://vulners.com/cnvd/CNVD-2020-46837
|       CC3F6C15-182F-53F6-A5CC-812D37F1F047    10.0    https://vulners.com/githubexploit/CC3F6C15-182F-53F6-A5CC-812D37F1F047  *EXPLOIT*
|       A41B5EAD-1A4C-56A6-97C6-1C58A1CF1E3B    10.0    https://vulners.com/githubexploit/A41B5EAD-1A4C-56A6-97C6-1C58A1CF1E3B  *EXPLOIT*
|       817CD8FE-87C4-5FE8-B9B2-8CC64333A3F3    10.0    https://vulners.com/githubexploit/817CD8FE-87C4-5FE8-B9B2-8CC64333A3F3  *EXPLOIT*
|       5F4BCEDE-77DF-5D54-851A-0AE8B76458D9    10.0    https://vulners.com/githubexploit/5F4BCEDE-77DF-5D54-851A-0AE8B76458D9  *EXPLOIT*
|       50580586-73C4-5097-81CA-546D6591DF44    10.0    https://vulners.com/githubexploit/50580586-73C4-5097-81CA-546D6591DF44  *EXPLOIT*
|_      1337DAY-ID-36095        9.8     https://vulners.com/zdt/1337DAY-ID-36095        *EXPLOIT*
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2011-2523  BID:48539
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://www.securityfocus.com/bid/48539
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|_      http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
|_http-trace: TRACE is enabled
| http-csrf: 
| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.168.132
|   Found the following possible CSRF vulnerabilities: 
|     
|     Path: http://192.168.168.132:80/dvwa/
|     Form id: 
|     Form action: login.php
|     
|     Path: http://192.168.168.132:80/mutillidae/index.php?page=user-info.php
|     Form id: id-bad-cred-tr
|     Form action: ./index.php?page=user-info.php
|     
|     Path: http://192.168.168.132:80/mutillidae/?page=source-viewer.php
|     Form id: id-bad-cred-tr
|     Form action: index.php?page=source-viewer.php
|     
|     Path: http://192.168.168.132:80/mutillidae/?page=view-someones-blog.php
|     Form id: id-bad-blog-entry-tr
|     Form action: index.php?page=view-someones-blog.php
|     
|     Path: http://192.168.168.132:80/mutillidae/index.php?page=source-viewer.php
|     Form id: id-bad-cred-tr
|     Form action: index.php?page=source-viewer.php
|     
|     Path: http://192.168.168.132:80/mutillidae/?page=text-file-viewer.php
|     Form id: id-bad-cred-tr
|     Form action: index.php?page=text-file-viewer.php
|     
|     Path: http://192.168.168.132:80/mutillidae/?page=user-info.php
|     Form id: id-bad-cred-tr
|     Form action: ./index.php?page=user-info.php
|     
|     Path: http://192.168.168.132:80/mutillidae/index.php?page=register.php
|     Form id: id-bad-cred-tr
|_    Form action: index.php?page=register.php
| vulners: 
|   cpe:/a:apache:http_server:2.2.8: 
|       SSV:69341       10.0    https://vulners.com/seebug/SSV:69341    *EXPLOIT*
|       SSV:19282       10.0    https://vulners.com/seebug/SSV:19282    *EXPLOIT*
|       SSV:19236       10.0    https://vulners.com/seebug/SSV:19236    *EXPLOIT*
|       SSV:11999       10.0    https://vulners.com/seebug/SSV:11999    *EXPLOIT*
|       PACKETSTORM:86964       10.0    https://vulners.com/packetstorm/PACKETSTORM:86964       *EXPLOIT*
|       PACKETSTORM:180533      10.0    https://vulners.com/packetstorm/PACKETSTORM:180533      *EXPLOIT*
|       MSF:AUXILIARY-DOS-HTTP-APACHE_MOD_ISAPI-        10.0    https://vulners.com/metasploit/MSF:AUXILIARY-DOS-HTTP-APACHE_MOD_ISAPI- *EXPLOIT*
|       HTTPD:E74B6F3660D13C4DD05DF3A83EA61631  10.0    https://vulners.com/httpd/HTTPD:E74B6F3660D13C4DD05DF3A83EA61631
|       HTTPD:81180E4E634CDECC9784146016B4A949  10.0    https://vulners.com/httpd/HTTPD:81180E4E634CDECC9784146016B4A949
|       EXPLOITPACK:30ED468EC8BD5B71B2CB93825A852B80    10.0    https://vulners.com/exploitpack/EXPLOITPACK:30ED468EC8BD5B71B2CB93825A852B80      *EXPLOIT*
|       EDB-ID:14288    10.0    https://vulners.com/exploitdb/EDB-ID:14288      *EXPLOIT*
|       EDB-ID:11650    10.0    https://vulners.com/exploitdb/EDB-ID:11650      *EXPLOIT*
|       CVE-2010-0425   10.0    https://vulners.com/cve/CVE-2010-0425
|       3E6BA608-776F-5B1F-9BA5-589CD2A5A351    10.0    https://vulners.com/gitee/3E6BA608-776F-5B1F-9BA5-589CD2A5A351  *EXPLOIT*
|       PACKETSTORM:171631      9.8     https://vulners.com/packetstorm/PACKETSTORM:171631      *EXPLOIT*
|       HTTPD:E69E9574251973D5AF93FA9D04997FC1  9.8     https://vulners.com/httpd/HTTPD:E69E9574251973D5AF93FA9D04997FC1
|       HTTPD:E162D3AE025639FEE2A89D5AF40ABF2F  9.8     https://vulners.com/httpd/HTTPD:E162D3AE025639FEE2A89D5AF40ABF2F
|       HTTPD:C072933AA965A86DA3E2C9172FFC1569  9.8     https://vulners.com/httpd/HTTPD:C072933AA965A86DA3E2C9172FFC1569
|       HTTPD:A1BBCE110E077FFBF4469D4F06DB9293  9.8     https://vulners.com/httpd/HTTPD:A1BBCE110E077FFBF4469D4F06DB9293
|       HTTPD:A09F9CEBE0B7C39EDA0480FEAEF4FE9D  9.8     https://vulners.com/httpd/HTTPD:A09F9CEBE0B7C39EDA0480FEAEF4FE9D
|       HTTPD:9F5406E0F4A0B007A0A4C9C92EF9813B  9.8     https://vulners.com/httpd/HTTPD:9F5406E0F4A0B007A0A4C9C92EF9813B
|       HTTPD:9BCBE3C14201AFC4B0F36F15CB40C0F8  9.8     https://vulners.com/httpd/HTTPD:9BCBE3C14201AFC4B0F36F15CB40C0F8
|       HTTPD:2BE0032A6ABE7CC52906DBAAFE0E448E  9.8     https://vulners.com/httpd/HTTPD:2BE0032A6ABE7CC52906DBAAFE0E448E
|       EDB-ID:51193    9.8     https://vulners.com/exploitdb/EDB-ID:51193      *EXPLOIT*
|       ECC3E825-EE29-59D3-BE28-1B30DB15940E    9.8     https://vulners.com/githubexploit/ECC3E825-EE29-59D3-BE28-1B30DB15940E  *EXPLOIT*
|       D5084D51-C8DF-5CBA-BC26-ACF2E33F8E52    9.8     https://vulners.com/githubexploit/D5084D51-C8DF-5CBA-BC26-ACF2E33F8E52  *EXPLOIT*
|       CVE-2022-31813  9.8     https://vulners.com/cve/CVE-2022-31813
|       CVE-2022-22720  9.8     https://vulners.com/cve/CVE-2022-22720
|       CVE-2021-44790  9.8     https://vulners.com/cve/CVE-2021-44790
|       CVE-2021-39275  9.8     https://vulners.com/cve/CVE-2021-39275
|       CVE-2018-1312   9.8     https://vulners.com/cve/CVE-2018-1312
|       CVE-2017-7679   9.8     https://vulners.com/cve/CVE-2017-7679
|       CVE-2017-3169   9.8     https://vulners.com/cve/CVE-2017-3169
|       CVE-2017-3167   9.8     https://vulners.com/cve/CVE-2017-3167
|       CNVD-2022-51061 9.8     https://vulners.com/cnvd/CNVD-2022-51061
|       CNVD-2022-03225 9.8     https://vulners.com/cnvd/CNVD-2022-03225
|       CNVD-2021-102386        9.8     https://vulners.com/cnvd/CNVD-2021-102386
|       B6297446-2DDD-52BA-B508-29A748A5D2CC    9.8     https://vulners.com/githubexploit/B6297446-2DDD-52BA-B508-29A748A5D2CC  *EXPLOIT*
|       1337DAY-ID-38427        9.8     https://vulners.com/zdt/1337DAY-ID-38427        *EXPLOIT*
|       0DB60346-03B6-5FEE-93D7-FF5757D225AA    9.8     https://vulners.com/gitee/0DB60346-03B6-5FEE-93D7-FF5757D225AA  *EXPLOIT*
|       HTTPD:509B04B8CC51879DD0A561AC4FDBE0A6  9.1     https://vulners.com/httpd/HTTPD:509B04B8CC51879DD0A561AC4FDBE0A6
|       HTTPD:459EB8D98503A2460C9445C5B224979E  9.1     https://vulners.com/httpd/HTTPD:459EB8D98503A2460C9445C5B224979E
|       HTTPD:2C227652EE0B3B961706AAFCACA3D1E1  9.1     https://vulners.com/httpd/HTTPD:2C227652EE0B3B961706AAFCACA3D1E1
|       FD2EE3A5-BAEA-5845-BA35-E6889992214F    9.1     https://vulners.com/githubexploit/FD2EE3A5-BAEA-5845-BA35-E6889992214F  *EXPLOIT*
|       FBC8A8BE-F00A-5B6D-832E-F99A72E7A3F7    9.1     https://vulners.com/githubexploit/FBC8A8BE-F00A-5B6D-832E-F99A72E7A3F7  *EXPLOIT*
|       E606D7F4-5FA2-5907-B30E-367D6FFECD89    9.1     https://vulners.com/githubexploit/E606D7F4-5FA2-5907-B30E-367D6FFECD89  *EXPLOIT*
|       D8A19443-2A37-5592-8955-F614504AAF45    9.1     https://vulners.com/githubexploit/D8A19443-2A37-5592-8955-F614504AAF45  *EXPLOIT*
|       CVE-2024-40898  9.1     https://vulners.com/cve/CVE-2024-40898
|       CVE-2022-28615  9.1     https://vulners.com/cve/CVE-2022-28615
|       CVE-2022-22721  9.1     https://vulners.com/cve/CVE-2022-22721
|       CVE-2017-9788   9.1     https://vulners.com/cve/CVE-2017-9788
|       CNVD-2022-51060 9.1     https://vulners.com/cnvd/CNVD-2022-51060
|       CNVD-2022-41638 9.1     https://vulners.com/cnvd/CNVD-2022-41638
|       B5E74010-A082-5ECE-AB37-623A5B33FE7D    9.1     https://vulners.com/githubexploit/B5E74010-A082-5ECE-AB37-623A5B33FE7D  *EXPLOIT*
|       HTTPD:1B3D546A8500818AAC5B1359FE11A7E4  9.0     https://vulners.com/httpd/HTTPD:1B3D546A8500818AAC5B1359FE11A7E4
|       FDF3DFA1-ED74-5EE2-BF5C-BA752CA34AE8    9.0     https://vulners.com/githubexploit/FDF3DFA1-ED74-5EE2-BF5C-BA752CA34AE8  *EXPLOIT*
|       CVE-2021-40438  9.0     https://vulners.com/cve/CVE-2021-40438
|       CNVD-2022-03224 9.0     https://vulners.com/cnvd/CNVD-2022-03224
|       AE3EF1CC-A0C3-5CB7-A6EF-4DAAAFA59C8C    9.0     https://vulners.com/githubexploit/AE3EF1CC-A0C3-5CB7-A6EF-4DAAAFA59C8C  *EXPLOIT*
|       9D9B3F4D-6B5C-5377-BE39-F1C432C9E457    9.0     https://vulners.com/githubexploit/9D9B3F4D-6B5C-5377-BE39-F1C432C9E457  *EXPLOIT*
|       8AFB43C5-ABD4-52AD-BB19-24D7884FF2A2    9.0     https://vulners.com/githubexploit/8AFB43C5-ABD4-52AD-BB19-24D7884FF2A2  *EXPLOIT*
|       7F48C6CF-47B2-5AF9-B6FD-1735FB2A95B2    9.0     https://vulners.com/githubexploit/7F48C6CF-47B2-5AF9-B6FD-1735FB2A95B2  *EXPLOIT*
|       36618CA8-9316-59CA-B748-82F15F407C4F    9.0     https://vulners.com/githubexploit/36618CA8-9316-59CA-B748-82F15F407C4F  *EXPLOIT*
|       CVE-2025-58098  8.3     https://vulners.com/cve/CVE-2025-58098
|       CNVD-2021-102387        8.2     https://vulners.com/cnvd/CNVD-2021-102387
|       B0A9E5E8-7CCC-5984-9922-A89F11D6BF38    8.2     https://vulners.com/githubexploit/B0A9E5E8-7CCC-5984-9922-A89F11D6BF38  *EXPLOIT*
|       HTTPD:30E0EE442FF4843665FED4FBCA25406A  8.1     https://vulners.com/httpd/HTTPD:30E0EE442FF4843665FED4FBCA25406A
|       CVE-2016-5387   8.1     https://vulners.com/cve/CVE-2016-5387
|       CNVD-2016-04948 8.1     https://vulners.com/cnvd/CNVD-2016-04948
|       SSV:72403       7.8     https://vulners.com/seebug/SSV:72403    *EXPLOIT*
|       SSV:2820        7.8     https://vulners.com/seebug/SSV:2820     *EXPLOIT*
|       SSV:26043       7.8     https://vulners.com/seebug/SSV:26043    *EXPLOIT*
|       SSV:20899       7.8     https://vulners.com/seebug/SSV:20899    *EXPLOIT*
|       SSV:11569       7.8     https://vulners.com/seebug/SSV:11569    *EXPLOIT*
|       PACKETSTORM:180517      7.8     https://vulners.com/packetstorm/PACKETSTORM:180517      *EXPLOIT*
|       PACKETSTORM:126851      7.8     https://vulners.com/packetstorm/PACKETSTORM:126851      *EXPLOIT*
|       PACKETSTORM:123527      7.8     https://vulners.com/packetstorm/PACKETSTORM:123527      *EXPLOIT*
|       PACKETSTORM:122962      7.8     https://vulners.com/packetstorm/PACKETSTORM:122962      *EXPLOIT*
|       MSF:AUXILIARY-DOS-HTTP-APACHE_RANGE_DOS-        7.8     https://vulners.com/metasploit/MSF:AUXILIARY-DOS-HTTP-APACHE_RANGE_DOS- *EXPLOIT*
|       HTTPD:556E7FA885F1BEDB6E3D9AAB5665198F  7.8     https://vulners.com/httpd/HTTPD:556E7FA885F1BEDB6E3D9AAB5665198F

```

## Übung (very safe FTP backdoor)
Der vuln-scan auf Metasploitable Port 21/FTP liefert Hinweis auf eine Schwachstelle, verwende die angezeigte CVE Nummer um genaueres über diese herauszufinden.


**CVE‑2011‑2523 (vsftpd 2.3.4 Backdoor)**

In vsftpd 2.3.4 wurde eine Backdoor entdeckt, die durch eine manipulierte Version entstanden ist.

Wenn man sich mit einem Benutzernamen mit ```:)``` anmeldet, öffnet der Server eine Shell auf Port 6200.

Auswirkung:
- Remote Code Execution
- Unauthentifizierter Zugriff
- In vielen Fällen direkter Shell‑Zugriff auf das System

Hier ist kein gültiger Login nötig und ist somit sehr ausnutzbar

Der vuln‑Scan findet korrekt eine FTP‑Schwachstelle, die einen direkten Einstieg ins System ermöglicht.


```bash
nmap -Pn -sS -sV --script CVE‑2011‑2523 192.168.168.132 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 07:18 EST
NSE: failed to initialize the script engine:
/usr/share/nmap/nse_main.lua:829: 'CVE‑2011‑2523' did not match a category, filename, or directory
stack traceback:
        [C]: in function 'error'
        /usr/share/nmap/nse_main.lua:829: in local 'get_chosen_scripts'
        /usr/share/nmap/nse_main.lua:1364: in main chunk
        [C]: in ?

QUITTING!

```